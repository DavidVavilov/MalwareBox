import os
import sys
import yara

def main():
   """
   A main function that gets a file from the command line arguments and runs a Yara rules check
   on the file and then prints the rules that match in the file.
   """
   rules = yara.compile(filepaths={'1' : 'capabilities_index.yar', '2' :'crypto_index.yar', '3' :'email_index.yar', '4' :'exploit_kits_index.yar', 
                                 '5' :'maldocs_index.yar', '6' :'malware_index.yar', '7' : 'mobile_malware_index.yar', '8' :'packers_index.yar'})

   fileName = sys.argv[1]
   matches = rules.match(data=open(fileName).read())
   print(matches)

if __name__ == "__main__":
   main()