#ifndef EVENTSINKCREATION_H
#define EVENTSINKCREATION_H

#define _WIN32_DCOM
#include <iostream>
using namespace std;
#include <comdef.h>
#include <Wbemidl.h>
#include <sstream>

#pragma comment(lib, "wbemuuid.lib")

class EventSinkCreationEvent : public IWbemObjectSink
{
public:
    EventSinkCreationEvent() { m_lRef = 0; }
    ~EventSinkCreationEvent() { bDone = true; }

    virtual ULONG STDMETHODCALLTYPE AddRef();
    virtual ULONG STDMETHODCALLTYPE Release();
    virtual HRESULT
        STDMETHODCALLTYPE QueryInterface(REFIID riid, void** ppv);

    virtual HRESULT STDMETHODCALLTYPE Indicate(
        LONG lObjectCount,
        IWbemClassObject __RPC_FAR* __RPC_FAR* apObjArray
    );

    virtual HRESULT STDMETHODCALLTYPE SetStatus(
        /* [in] */ LONG lFlags,
        /* [in] */ HRESULT hResult,
        /* [in] */ BSTR strParam,
        /* [in] */ IWbemClassObject __RPC_FAR* pObjParam
    );

    /// <summary>
    /// getter for outString
    /// </summary>
    /// <returns>
    /// outString | type: string
    /// </returns>
    std::string getOutString() const;

private:
    std::stringstream outString;

    LONG m_lRef;
    bool bDone;
};

#endif
